<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>巡检任务管理</title>
    <link type="text/css" href="webjars/bootstrap" th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.css}"
          rel="stylesheet">

    <!--//<script src="js/jquery.form.js" type="text/javascript"></script>-->
    <link rel="stylesheet" type="text/css" href="css/ShowPage.css"/>
    <script th:src="@{/webjars/jquery/3.4.1/jquery.js}"></script>
    <script th:src="@{/webjars/bootstrap3.3.7/js/bootstrap.js}"></script>
    <script src="js/jsform.js" type="text/javascript"></script>
    <link rel="stylesheet" href="css/datepicker.css">
    <script src="js/moment.js"></script>
    <script src="js/datepicker.js"></script>
    <script src="js/date.js"></script>
    <!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js" integrity="sha384-FzT3vTVGXqf7wRfy8k4BiyzvbNfeYjK+frTVqZeNDFl8woCbF0CYG6g2fMEFFo/i" crossorigin="anonymous"></script>-->
</head>
<style>
    #van {
        padding: 20px;
    }

    .row input[type='text'] {
        width: 200px;
    }

    .input-group {
        margin-bottom: 8px;
    }

    .input-group-addon {
        width: 90px;
    }
    tr,td{
        vertical-align:middle;
    }
    .he {
        display: inline-block;
        text-align: center;
        font-size: larger;
        font-weight: bolder;
    }
</style>
<body>
<p id="van">
    <span>消缺任务管理</span>
    <span>&gt;&gt;&nbsp;</span>
    <span>消缺任务制定与分配</span>
</p>
<div class="row">
    <form id="su">
        <div class="col-lg-9 col-sm-9 col-xs-9 ">
            <div class="col-lg-4 col-sm-6 col-xs-12">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon" style="">任务编号:</span>
                    <input type="text" name="jobId" id="jobId" class="form-control" value="">
                </div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon">线路编号:</span>
                    <input type="text" name="circuitNo" id="circuitNo" class="form-control" value="">
                </div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon">任务状态:</span>
                    <select name="flawTypeId" class="form-control">
                        <option value="">-请选择-</option>
                        <option value="待分配">待分配</option>
                        <option value="已分配">已分配</option>
                        <option value="执行中">执行中</option>
                        <option value="已完成">已完成</option>
                    </select>
                </div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon">下发人:&nbsp;&nbsp;</span>
                    <input type="text" name="checkByName" id="checkBy" class="form-control" value="">
                </div>
                <div></div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon">发现时间:</span>

                    <div class="  J-datepicker-range-day  form-control date" style="width: 200px">
                        <input placeholder="开始日期" name="CreateDateMin" class="c-datepicker-data-input only-date"
                               style="width: 77px">
                        <span class="c-datepicker-range-separator">-</span>
                        <input placeholder="结束日期" name="CreateDateMax" class="c-datepicker-data-input only-date"
                               style="width: 77px">
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <input hidden="hidden" name="pageIndex" id="pageIndex" value="1">
                <input hidden="hidden" name="pageSize" id="pageSize" value="4">
                <button type="submit"  class="btn btn-primary btn-regist">查询</button>
                <input hidden="hidden" id="pageCount" value="10">
            </div>
        </div>
    </form>
</div>


<div class="col-lg-12 col-sm-12col-sm-12 ">

    <div class="col-lg-12 col-md-12 col-sm-12 ">
        <div class=" col-lg-3 col-md-3 col-sm-3 col-lg-push-9 col-md-push-9 col-sm-push-9 ">
            <a class="btn btn-primary" href="addChecktask.html"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>制定消缺任务</a>
        </div>

    </div>

</div>

<!-- 条纹表格 -->
<table class="table table-striped">

</table>


<div class="row" style="padding: 50px">
    <div class="col-sm-12">
        <table id="datatable" class="table table-striped table-bordered dataTable no-footer" role="grid"
               aria-describedby="datatable_info"  style="text-align: center ">
            <thead>
            <tr role="row">
                <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-sort="ascending" aria-label="Name: activate to sort column descending"
                    style="width:80px; text-align: center;vertical-align: middle">任务编号
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Position: activate to sort column ascending" style="width:100px;text-align: center;vertical-align: middle">任务名称
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width:80px;text-align: center;vertical-align: middle">巡检线路
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width:80px;text-align: center;vertical-align: middle">起始杆号
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width:80px;text-align: center;vertical-align: middle">终止杆号
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width:80px;text-align: center;vertical-align: middle">下发人
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width:80px;text-align: center;vertical-align: middle">下发时间
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width:60px;text-align: center;vertical-align: middle">任务状态
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width:60px;text-align: center;vertical-align: middle">完成时间
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width: 60px;text-align: center;vertical-align: middle">是否取消
                </th>
                <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                    aria-label="Office: activate to sort column ascending" style="width: 241px;text-align: center;vertical-align: middle">操作
                </th>
            </tr>
            </thead>
            <tbody id="app">

            </tbody>
        </table>
    </div>
</div>

<div class="zxf_pagediv"></div>
</body>

<script src="js/ShowPage.js" type="text/javascript"></script>
<script type="text/javascript">
    function submint() {
        $("#su").ajaxSubmit({
            type: "post",  //提交方式
            dataType: "html", //数据类型
            async:false,
            url: "getchecktaskList.html", //请求url
            success: function (data) {//提交成功的回调函数
                $("#pageCount").val(data.pageCount);
                var options=""
                $.each(data.dataList, function (i, obj) {
                    var statusStr="";
                    var jobId = obj.jobId == null ? "" : obj.jobId;
                    var jobName = obj.jobName == null ? "" : obj.jobName;
                    var circuitName = obj.circuitName == null ? "" : obj.circuitName;
                    var createByName = obj.createByName == null ? "" : obj.createByName;
                    var startNo = obj.startNo == null ? "" : obj.startNo;
                    var stopNo = obj.stopNo == null ? "" : obj.stopNo;
                    var abolish = obj.abolish == null ? "" : obj.abolish;
                    switch (obj.status) {
                        case "待分配":
                            statusStr= "<td  style='color:orange'>" + obj.status + "</td>";
                            break;
                        case "已分配":
                            statusStr= "<td  style='color:blue'>" + obj.status + "</td>";
                            break;
                        case "执行中":
                            statusStr= "<td  style='color:purple'>" + obj.status + "</td>";
                            break;
                        case "已完成":
                            statusStr= "<td  style='color:green'>" + obj.status + "</td>";
                            break;
                        default:
                            statusStr="<td >" +obj.status + "</td>";
                            break;
                    }
                    var createDate;
                    if (obj.createDate == null) {
                        createDate = " ";
                    } else {
                        var date = new Date(obj.createDate == null ? "" : obj.createDate);
                        createDate = date.getFullYear() + "/" + eval(date.getMonth() + "+1") + "/" + date.getDate()
                    }
                    var fDate;
                    if (obj.finishDate == null) {
                        fDate = " ";
                    } else {
                        var date2 = new Date(obj.finishDate == null ? "" : obj.finishDate);
                        fDate = date2.getFullYear() + "/" + eval(date2.getMonth() + "+1") + "/" + date2.getDate()
                    }
                    var trsTR = "<a href=\"showChecktask.html?jobId="+jobId+"\">查看</a>" +
                        "                    <span>|</span>" +
                        "                    <a href=\"\">分配任务</a>" +
                        "                    <span>|</span>" +
                        "<a href=\"updateChecktask.html?jobId="+jobId+"\">修改</a>" +
                        "                    <span>|</span>" +
                        "                    <a href=\"\">取消</a>" ;
                    options+=
                        "<tr style='vertical-align: middle'><td>"+jobId+"</td>"+
                        "<td>"+jobName+"</td>"+
                        "<td>"+circuitName+"</td>"+
                        "<td>"+startNo+"</td>"+
                        "<td>"+stopNo+"</td>"+
                        "<td>"+createByName+"</td>"+
                        "<td>"+createDate+"</td>"+statusStr+
                        "<td>"+fDate+"</td>"+
                        "<td>"+abolish+"</td>"+
                        "<td>"+trsTR+"</td></tr>";
                });
                $("#app").html(options);

            }
        });
        return false; //不刷新页面
    }


    $(function () {
        submint();
        $("#su").submit(function () {
            submint();
            return false;
        });
        $(document).on("click", "a.zxfPagenum", function () {
            var cur = parseInt($(this).text());
            $("#pageIndex").val(cur);
            submint();
        });
        $(document).on("click", "a.prebtn", function () {
            var cur = parseInt($("span.current").text());
            $("#pageIndex").val(cur);
            submint();
        });
        $(document).on("click", "a.nextbtn", function () {
            var cur = parseInt($("span.current").text());
            $("#pageIndex").val(cur);
            submint();
        });

        $(document).on("click","span.zxfokbtn",function(){
            var cur = parseInt($("input.zxfinput").val());
            $("#pageIndex").val(cur);
            if(cur>$("#pageCount").val()){return;}
            submint();
        });
        $(".zxf_pagediv").createPage({
            pageNum:$("#pageCount").val(),
            current:1,
            backfun: function(e) {
            }
        });
    })
</script>
</html>