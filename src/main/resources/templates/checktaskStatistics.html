<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>巡检记录统计</title>
    <script th:src="@{/webjars/bootstrap/3.3.7/js/bootstrap.js}"></script>
    <script th:src="@{/webjars/jquery/3.4.1/jquery.js}"></script>
    <link type="text/css" href="webjars/bootstrap" th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.css}"
          rel="stylesheet">
    <link rel="stylesheet" href="css/datepicker.css">
    <script src="js/moment.js"></script>
    <script src="js/datepicker.js"></script>
    <script src="js/date.js"></script>
    <link rel="stylesheet" type="text/css" href="css/ShowPage.css"/>
    <script src="js/ShowPage.js" type="text/javascript"></script>

    <style>
        #van {
            padding: 30px 50px 20px 20px;
        }

        .form-control {
            width: 200px;
        }

        .input-group {
            margin: 5px;
        }

        .input-group-addon {
            width: 90px;
        }

        td,th {
            text-align: center;
        }
    </style>
</head>
<body>

<p id="van">
    <span>信息统计</span>
    <span>&gt;&gt;&nbsp;</span>
    <span>巡检记录统计</span>
</p>

<!-------筛选------->
<div class="row " style="padding: 0px 50px 50px 50px">
    <form id="su">
        <div class="col-lg-9 col-sm-9 col-xs-9 ">
            <div class="col-lg-4 col-sm-6 col-xs-12">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon" style="">任务编号:</span>
                    <input type="text" name="jobId" id="jobId" class="form-control" value="">
                </div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon">线路编号:</span>
                    <input type="text" name="circuitNo" id="circuitNo" class="form-control" value="">
                </div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <div class="input-prepend input-group">
                    <span class="add-on input-group-addon">发现时间:</span>

                    <div class="  J-datepicker-range-day  form-control date" style="width: 200px">
                        <input placeholder="开始日期" name="CreateDateMin" class="c-datepicker-data-input only-date"
                               style="width: 77px">
                        <span class="c-datepicker-range-separator">-</span>
                        <input placeholder="结束日期" name="CreateDateMax" class="c-datepicker-data-input only-date"
                               style="width: 77px">
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-sm-6 col-xs-12 ">
                <input hidden="hidden" name="pageIndex" id="pageIndex" value="1">
                <input hidden="hidden" name="pageSize" id="pageSize" value="4">
                <button type="submit"  class="btn btn-primary btn-regist">查询</button>
                <input hidden="hidden" id="pageCount" value="10">
            </div>
        </div>
    </form>
</div>





<div class="row">
    <!-- lh表格 -->
    <div class="row" style="padding: 10px 50px 50px 65px">
        <div class="col-sm-12">
            <table id="datatable" class="table table-striped table-bordered dataTable no-footer" role="grid"
                   aria-describedby="datatable_info" style="text-align: center">
                <thead>
                <tr role="row" >

                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Position: activate to sort column ascending" style="width: 141px;text-align: center">任务编号
                    </th>
                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Position: activate to sort column ascending" style="width: 161px;text-align: center">任务名称
                    </th>
                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Position: activate to sort column ascending" style="width: 260px;text-align: center">线路编号(起始杆号-终止杆号)
                    </th>
                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Position: activate to sort column ascending" style="width: 161px;text-align: center">杆塔编号
                    </th>
                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Position: activate to sort column ascending" style="width: 181px;text-align: center">缺陷级别
                    </th>
                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Position: activate to sort column ascending" style="width: 181px;text-align: center">缺陷类型
                    </th>
                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Office: activate to sort column ascending" style="width: 161px;text-align: center">发现时间
                    </th>
                    <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1"
                        aria-label="Office: activate to sort column ascending" style="width: 230px;text-align: center">缺陷描述
                    </th>
                </tr>
                </thead>

                <tbody id="app">

                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="zxf_pagediv">

</div>
</body>
</html>
<script src="js/ShowPage.js" type="text/javascript"></script>
<script src="js/StatisticsPage.js" type="text/javascript"></script>

<script src="js/ShowPage.js" type="text/javascript"></script>
<script type="text/javascript">
    function submint() {
        $("#su").ajaxSubmit({
            type: "post",  //提交方式
            dataType: "json", //数据类型
            async:false,
            url: "getchecktaskList.html", //请求url
            success: function (data) {//提交成功的回调函数
                $("#pageCount").val(data.pageCount);
                var options=""
                $.each(data.dataList, function (i, obj) {
                    var statusStr="";
                    var jobId = obj.jobId == null ? "" : obj.jobId;
                    var jobName = obj.jobName == null ? "" : obj.jobName;
                    var circuitName = obj.circuitName == null ? "" : obj.circuitName;
                    var createByName = obj.createByName == null ? "" : obj.createByName;
                    var startNo = obj.startNo == null ? "" : obj.startNo;
                    var stopNo = obj.stopNo == null ? "" : obj.stopNo;
                    var abolish = obj.abolish == null ? "" : obj.abolish;
                    switch (obj.status) {
                        case "待分配":
                            statusStr= "<td  style='color:orange'>" + obj.status + "</td>";
                            break;
                        case "已分配":
                            statusStr= "<td  style='color:blue'>" + obj.status + "</td>";
                            break;
                        case "执行中":
                            statusStr= "<td  style='color:purple'>" + obj.status + "</td>";
                            break;
                        case "已完成":
                            statusStr= "<td  style='color:green'>" + obj.status + "</td>";
                            break;
                        default:
                            statusStr="<td >" +obj.status + "</td>";
                            break;
                    }
                    var createDate;
                    if (obj.createDate == null) {
                        createDate = " ";
                    } else {
                        var date = new Date(obj.createDate == null ? "" : obj.createDate);
                        createDate = date.getFullYear() + "/" + eval(date.getMonth() + "+1") + "/" + date.getDate()
                    }
                    var fDate;
                    if (obj.finishDate == null) {
                        fDate = " ";
                    } else {
                        var date2 = new Date(obj.finishDate == null ? "" : obj.finishDate);
                        fDate = date2.getFullYear() + "/" + eval(date2.getMonth() + "+1") + "/" + date2.getDate()
                    }
                    var trsTR = "<a href=\"showChecktask.html?jobid="+jobId+"\">查看</a>" +
                        "                    <span>|</span>" +
                        "                    <a href=\"\">分配任务</a>" +
                        "                    <span>|</span>" +
                        "<a href=\"updateChecktask.html?jobId="+jobId+"\">修改</a>" +
                        "                    <span>|</span>" +
                        "                    <a href=\"\">取消</a>" ;
                    options+=
                        "<tr style='vertical-align: middle'><td>"+jobId+"</td>"+
                        "<td>"+jobName+"</td>"+
                        "<td>"+circuitName+"</td>"+
                        "<td>"+startNo+"</td>"+
                        "<td>"+stopNo+"</td>"+
                        "<td>"+createByName+"</td>"+
                        "<td>"+createDate+"</td>"+statusStr+
                        "<td>"+fDate+"</td>"+
                        "<td>"+abolish+"</td>"+
                        "<td>"+trsTR+"</td></tr>";
                });
                $("#app").html(options);
            }
        });
        return false; //不刷新页面
    }


    $(function () {
        submint();
        $("#su").submit(function () {
            submint();
            return false;
        });
        $(document).on("click", "a.zxfPagenum", function () {
            var cur = parseInt($(this).text());
            $("#pageIndex").val(cur);
            submint();
        });
        $(document).on("click", "a.prebtn", function () {
            var cur = parseInt($("span.current").text());
            $("#pageIndex").val(cur);
            submint();
        });
        $(document).on("click", "a.nextbtn", function () {
            var cur = parseInt($("span.current").text());
            $("#pageIndex").val(cur);
            submint();
        });

        $(document).on("click","span.zxfokbtn",function(){
            var cur = parseInt($("input.zxfinput").val());
            $("#pageIndex").val(cur);
            if(cur>$("#pageCount").val()){return;}
            submint();
        });
        $(".zxf_pagediv").createPage({
            pageNum:$("#pageCount").val(),
            current:1,
            backfun: function(e) {
            }
        });
    })
</script>